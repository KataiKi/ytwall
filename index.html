<html>
<head>
<style>
    body {
        margin: 0;
    }
    #overlay {
        position: absolute;
        width:100%;
        height:100%;
        z-index:2;
    }        
</style>

</head>

<body>
<div id="overlay"></div>
<div id="player"></div>
    <script>
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    var params = (new URL(window.location.href)).searchParams;
    var v = params.get("v");
    var s = params.get("s") ? parseFloat(params.get("s")) : 0;
    var e = params.get("e") ? parseFloat(params.get("e")) : null;

    var player;
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
            videoId: v,
            width: '100%',
            height: '100%',
            playerVars: {
                modestbranding: 0,
                autoplay: 1,
                loop: 1,
                controls: 0,
                showinfo: 0,
                wmode: 'transparent',
                branding: 0,
                mute: 1,
                rel: 0,
                autohide: 0,
                origin: window.location.origin
            },
            events: {
                'onReady': onPlayerReady,
                'onStateChange': onPlayerStateChange
            }
        });
    }
    function onPlayerReady(event) {
        document.title = event.target.getVideoData().title;
        event.target.seekTo(s); console.log(s);
        event.target.playVideo();
        console.log("Ready");
    }
    function onPlayerStateChange(event) {
        var YTP=event.target;
        if(event.data===1){
            var remains= (e ? e : YTP.getDuration()) - YTP.getCurrentTime(); console.log(remains);
            if(this.rewindTO)
                clearTimeout(this.rewindTO);
            this.rewindTO=setTimeout(function(){
                 YTP.seekTo(s);
             },(remains-0.2)*1000);
        }
    }
    </script>
</body>
</html>
